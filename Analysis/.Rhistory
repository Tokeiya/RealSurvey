library(tidyverse)
library(forcats)
li
library(RSQLite)
con<-dbConnect(SQLite(),'../ResultSotrage.sqlite3')
dta<-dbGetQuery(con,'select * from difference where difference!=0')
View(dta)
nested<-dta %>% nest(-category)
View(nested)
nested %>% mutate(count=map_int(data,~count(.)[[1]]))
dta %>% nest(-category) %>% mutate(count=map_int(data,~count(.)[[1]]))
dta %>% nest(-category) %>% mutate(count=map_int(data,~count(.)[[1]])) %>% select(-data)
dta %>% nest(-category) %>% mutate(count=map_int(data,~count(.)[[1]])) %>% select(-data) %>% arrange(desc(count))
format(10000,big.mark = ',')
format(10000,big.mark = ',',small.interval = 2)
format(1,big.mark = ',',small.interval = 2)
format(1,big.mark = ',',digits = 10)
format(100000,big.mark = ',',digits = 3)
format(100000,big.mark = ',',digits = 10)
format(100000,big.mark = ',')
format(100000,big.mark = ',')
format(1000000,big.mark = ',')
format(1000000,big.mark = ',',10)
format(1000000,big.mark = ',',nsmall = 10)
format(1000000,big.mark = ',',nsmall =20)
format(10000,big.mark = ',',nsmall =20)
format(10000,big.mark = ',',nsmall =5)
format(10000,big.mark = ',',nsmall =4)
format(10000,big.mark = ',',nsmall =0)
rm(nested)
tmp<-dta %>% select(category,method,difference)
View(tmp)
hoge<-tmp %>% nest(-category) %>% rowid_to_column(var = 'category_id') %>% unnest()
View(hoge)
hoge<-tmp %>% nest(-category) %>% rowid_to_column(var = 'category_id') %>% unnest() %>% nest(-method) %>% rowid_to_column(var='method_id') %>% unnest()
hoge<-tmp %>% nest(-category) %>% rowid_to_column(var = 'category_id') %>% unnest() %>% nest(-method) %>% rowid_to_column(var='method_id') %>% unnest() %>% select(category_id,method_id,category,method,difference)
View(tmp)
rm(hoge)
hoge<-tmp %>% nest(-category) %>% mutate(d=map(data,~.%>%nest(-method))
)
View(hoge)
View(hoge[[2]][[1]])
hoge$data[[1]]
hoge$data
hoge$data[[1]]
hoge$data[[1]] %>% nest(-method)
hoge<-tmp %>% nest(-category,-method)
View(hoge)
hoge<-tmp %>% nest(-category) %>% mutate(d=map(data,~.))
View(hoge)
hoge<-tmp %>% nest(-category) %>% mutate(d=map(data,~.[[1]]))
View(hoge)
tmp<-as_tibble(tmp)
rm(hoge)
hoge<-tmp %>% nest(-category) %>% mutate(d=map(data,~ nest(.,-method)))
View(hoge)
View(hoge[[3]][[1]])
hoge<-tmp %>% nest(-category) %>% mutate(d=map(data,~ nest(.,-method)%>%mutate(count=count(data))))
hoge<-tmp %>% nest(-category) %>% mutate(count=count(data))
hoge<-tmp %>% nest(-category) %>% mutate(count=count(data)[[1]])
hoge<-tmp %>% nest(-category) %>% mutate(count=map_int(data,~count(.)[[1]])
)
View(hoge)
source('G:/RealSurvey/Analysis/difference_svy.R')
source('G:/RealSurvey/Analysis/difference_svy.R')
hoge
hoge %>% mutate(piyo=get_count(dadata))
hoge %>% mutate(piyo=get_count(data))
rm(hoge)
View(tmp)
hoge<-tmp %>% nest(-category) %>% mutate(dta=map(data,~nest(.,-method)))
View(hoge)
View(hoge[[3]][[1]])
hoge<-tmp %>% nest(-category) %>% mutate(dta=map(data,~nest(.,-method)%>% get_count(data)))
hoge<-tmp %>% nest(-category) %>% mutate(dta=map(data,function(x){
x %>% nest(-method)
}))
View(hoge)
View(hoge[[3]][[1]])
View((hoge[[3]][[1]])[[2]][[1]])
x %>% nest(-method) %>% mutate(cnt=get_count(data))
hoge<-tmp %>% nest(-category) %>% mutate(dta=map(data,function(x){
x %>% nest(-method) %>% mutate(cnt=get_count(data))
}))
View(hoge)
View(hoge[[3]][[1]])
hoge<-tmp %>% nest(-category) %>% mutate(dta=map(data,function(x){
x %>% nest(-method) %>% mutate(cnt=get_count(data)) %>% select(-data)
}))
View(hoge)
View(hoge[[3]][[1]])
hoge<-tmp %>% nest(-category) %>% mutate(dta=map(data,function(x){
x %>% nest(-method) %>% mutate(cnt=get_count(data)) %>% select(-data)
})) %>% select(-data)
View(hoge)
hoge<-tmp %>% nest(-category) %>% mutate(dta=map(data,function(x){
x %>% nest(-method) %>% mutate(cnt=get_count(data)) %>% select(-data)
})) %>% select(-data) %>% rowid_to_column(var = 'cat_id') %>% unnest
View(hoge)
piyo<-hoge %>% spread(-method,cnt)
View(piyo)
piyo<-hoge %>% spread(-category,cnt)
piyo<-piyo %>% select(category,Sin,Cos,Tan,SinCos)
View(hoge)
g<-ggplot(hoge,aes(x=category,y=cnt,fill=method)) %>% geom_bar(stat='identity',position = "dodge")
g<-ggplot(hoge,aes(x=category,y=cnt,fill=method)) %>% geom_bar(stat='identity',position = "dodge")
g<-ggplot(hoge,aes(x=category,y=cnt,fill=method))
g<-ggplot(hoge,aes(x=category,y=cnt,fill=method)) + geom_bar(stat='identity',position = "dodge")
plot(g)
g<-ggplot(hoge,aes(x=category,y=cnt,fill=method)) + geom_bar(stat='identity',position = "dodge")
+theme(axis.text.x = element_text(angle = 45,hjust = 0.5))
g<-ggplot(hoge,aes(x=category,y=cnt,fill=method)) + geom_bar(stat='identity',position = "dodge")+theme(axis.text.x = element_text(angle = 45,hjust = 0.5))
plot(g)
g<-ggplot(hoge,aes(x=category,y=cnt,fill=method)) + geom_bar(stat='identity',position = "dodge")+theme(axis.text.x = element_text(angle = 45,hjust = 1))
plot(g)
g<-ggplot(hoge %>% filter(method=='Sin'),aes(x=category,y=cnt,fill=method)) + geom_bar(stat='identity',position = "dodge")+theme(axis.text.x = element_text(angle = 45,hjust = 1))
plot(g)
g<-ggplot(hoge,aes(x=category,y=cnt,fill=method)) + geom_bar(stat='identity',position = "dodge")+theme(axis.text.x = element_text(angle = 45,hjust = 1))
plog(g)
plot(g)
View(piyo)
knitr::knit(piyo)
knitr(piyo)
kable(piyo)
library(knitr)
knitr::kable(piyo,format = 'markdown')
install.packages(c("openssl", "processx"))
library(tidyverse)
library(forcats)
library(RSQLite)
con<-dbConnect(SQLite(bigint=TRUE),'../ResultStrage.sqlite3');
con<-dbConnect(SQLite(),'../ResultStrage.sqlite3');
dat<-dbGetQuery(con,'select * from difference;') %>% select(-id);
dbDisconnect(con)
con<-dbConnect(SQLite(),'../Resul')
con<-dbConnect(SQLite(),'../Result.sq');
dbGetQuery(con,'select * from session')
con<-dbConnect(SQLite(),'..\\Result.sqlite3');
dbGetQuery(con,'select * from session')
dbDisconnect(con)
con<-dbConnect(SQLite(),'../DataStrage.sqlite3')
dta<-dbGetQuery(con,'select * from difference')
dta<-dbGetQuery(con,'select * from difference')
rm(con)
con<-dbConnect()
con<-dbConnect(SQLite(),'../ResultStrage.sqlite3');
dta<-dbGetQuery(con,'select * from difference')
dta<-dbGetQuery(con,'select * from difference where difference!=0')
ttlCnt<-dbGetQuery(con,'select count(*) from difference')
View(ttlCnt)
ttlCount
ttlCnt
ttlCnt[[1]]
ttlCnt[1]
library(kable)
library(knitr)
source('G:/RealSurvey/Analysis/difference_svy.R')
load()
loadLib
loadLib()
source('G:/RealSurvey/Analysis/difference_svy.R')
loadLib()
source('G:/RealSurvey/Analysis/difference_svy.R')
loadLib()
dta
dta<-as_tibble(dta)
lta
dta
cat_summary<-dta
cat_summary<-dta %>% select(category,difference) %>% nest(-category) %>% mutate(count=map_int)
cat_summary<-dta %>% select(category,difference) %>% nest(-category)
cat_summary
cat_summary<-dta %>% select(category,difference) %>% nest(-category) %>% mutate(count=get_count(data))
cat
cat_summary
cat_summary<-dta %>% select(category,difference) %>% nest(-category) %>% mutate(count=get_count(data)) %>% select(-data)
View(cat_summary)
rm(cat_summary)
rm(dta)
rm(ttlCnt)
ttlCnt<-dbGetQuery(con,'select count(*) from working')
con<-dbConnect(SQLite(),'../DataStrage.sqlite3')
ttlCnt<-dbGetQuery(con,'select count(*) from working')
rm(con)
con<-dbConnect(SQLite(),'../ResultStrage.sqlite3')
ttlCnt<-dbGetQuery(con,'SELECT count(*) FROM working')
ttlCnt
dta<-dbGetQuery(con,'SELECT first_category,second_category,difference FROM working')
dta<-dbGetQuery(con,'SELECT first_category,second_category,difference FROM working WHERE difference!=0')
dta<-dbGetQuery(con,'SELECT first_category,second_category,difference FROM working WHERE difference!=0') %>% as_tibble();
dta
tmp<-dta %>% mutate(first_category=fct_relevel('x64Windows','x64WindowsFMA3','Linux','macOS');
tmp<-dta %>% mutate(first_category=fct_relevel('x64Windows','x64WindowsFMA3','Linux','macOS'))
rm(tmp)
dta
dta %>% nest(-first_category)
tmp<-dta %>% mutate(first=as_factor(first_category)) %>% mutate(second=as_factor(second_category))
tmp<-dta %>% mutate(first=as_factor(first_category)) %>% mutate(second=as_factor(second_category)) %>% select(first,second,difference);
tmp
typeof(tmp$first)
tmp %>% mutate(first=map_int(first,~fct_relevel(.,'x64Windows','x64WindowsFMA3','Linux','macOS')))
tmp %>% mutate(first=map(first,~fct_relevel(.,'x64Windows','x64WindowsFMA3','Linux','macOS'))[[1]])
hoge<-tmp %>% mutate(first=map(first,~fct_relevel(.,'x64Windows','x64WindowsFMA3','Linux','macOS'))[[1]])
hoge
hoge %>% arrange(first)
hoge %>% arrange(Desc(first))
hoge %>% arrange(desc(first))
hoge %>% nest(-first)
hoge<-tmp
hoge
tmp %>% nest(-first)
typeof(tmp$first)
hoge<-tmp
hoge$first<-fct_relabel(hoge$first,'x64Windows','x64WindowsFMA3','macOS','Linux')
hoge<-tmp
hoge$first<-fct_relevel(hoge$first,'x64Windows','x64WindowsFMA3','macOS','Linux')
hoge
hoge %>% nest(-first)
hoge %>% nest(-first) %>% arrange(first)
typeof(hoge$second)
hoge$second<-fct_relabel(hoge$second,'x86Windows','x64Windwos','x64WindowsFMA3','macOS')
source('G:/RealSurvey/Analysis/difference_svy.R')
hoge<-tmp;
hoge
hoge$first<-relevel_category(hoge$first)
hoge$second<-relevel_category(hoge$second);
hoge %>% arrange(first)
hoge %>% arrange(second)
piyo<-hoge %>% nest(-first)
View(piyo)
View(piyo[[2]][[1]])
piyo<-hoge %>% nest(-first) %>% mutate(dta=map(data,~ .x %>% nest(-second)))
View(piyo)
View(piyo[[3]][[1]])
piyo<-hoge %>% nest(-first) %>% mutate(data=map(data,~ .x %>% nest(-second))) %>%
;
piyo<-hoge %>% nest(-first) %>% mutate(data=map(data,~ .x %>% nest(-second)))
View(piyo[[3]][[1]])
View(piyo[[2]][[1]])
piyo<-hoge %>% mutate(data=map(data,~ .x %>% mutate(count=map_int(data,~ count(.y)[[1]]))))
View(piyo)
piyo %>% mutate(count=map_int(data,~count(.)[[1]]))
View(piyo[[2]][[4]])
View(piyo[[2]][[1]])
View(hoge)
View(piyo)
View(piyo[[2]][[1]])
piyo %>% mutate(data=map(data,~ . %>% mutate(count=map_int(data,~ . %>% count()[[1]]))))
foo<-piyo %>% mutate(data=map(data,~ . %>% mutate(count=map_int(data,~ . %>% count()[[1]]))))
View(foo)
foo<-piyo %>% mutate(data=map(data,~ . %>% mutate(count=map(data,~ . %>% count()))))
View(foo)
foo<-piyo %>% mutate(data=map(data,~ . %>% mutate(count=map(data,~ . %>% count()))))
piyo %>% mutate(data=map(data,function(x){
x %>% mutate(count=map_int(data,~ . %>% count(.)[[1]])) }
)
))
piyo %>% mutate(data=map(data,function(x){
x %>% mutate(count=map_int(data,~ . %>% count(.)[[1]])) }))
piyo %>% mutate(data=map(data,function(a){
a %>% mutate(count=map_int(data,~ . %>% count(.)[[1]])) }))
piyo %>% mutate(data=map(data,function(a){a %>% mutate(count=map_int(data,function(b){ . %>% count(.)[[1]])) }}))
piyo %>% mutate(data=map(data,function(a){a %>% mutate(count=map_int(data,function(b){ . %>% count(.)[[1]])) }}))
piyo %>% mutte(data=map(data,function(a){
a %>% mutate(count=map_int(data,function(b){ . %>% count(.)[[1]])) }}))
View(piyo)
View(piyo[[2]][[1]])
View(piyo[[2]][[4]])
foo<-piyo %>% mutate(data=map(data,function(x){x %>% mutate(d=data)}))
View(foo)
View(foo[[2]][[1]])
foo<-piyo %>% mutate(data=map(data,function(x){x %>% mutate(cnt=map(data,function(y){y %>% count(y)}))}))
foo<-piyo %>% mutate(data=map(data,function(x){x %>% mutate(cnt=map(data,function(y){y %>% count()}))}))
View(foo)
View(foo[[2]][[1]])
View((foo[[2]][[1]])[[3]][[1]])
foo<-piyo %>% mutate(data=map(data,function(x){x %>% mutate(cnt=map_int(data,function(y){y %>% count()[[1]]}))}))
foo<-piyo %>% mutate(data=map(data,function(x){x %>% mutate(cnt=map_int(data,function(y){y %>% count()}))}))
foo<-piyo %>% mutate(data=map(data,function(x){x %>% mutate(cnt=map_int(data,function(y){y %>% count()$n}))}))
foo<-piyo %>% mutate(data=map(data,function(x){x %>% mutate(cnt=map(data,function(y){y %>% count()}))}))
View(foo[[2]][[1]])
View((foo[[2]][[1]])[[3]][[1]])
source('G:/RealSurvey/Analysis/difference_svy.R')
foo<-piyo %>% mutate(data=map(data,function(x){x %>% mutate(cnt=map(data,function(y){y %>% get_count()}))}))
foo<-piyo %>% mutate(data=map(data,function(x){x %>% mutate(cnt=map(data,function(y){get_count(y)}))}))
foo<-piyo %>% mutate(data=map(data,function(x){x %>% mutate(cnt=map(data,function(y){count(y)}))}))
View(foo[[2]][[1]])
View((foo[[2]][[1]])[[3]][[1]])
foo<-piyo %>% mutate(data=map(data,function(x){x %>% mutate(cnt=map(data,function(y){count(y)[[1]]}))}))
View(foo)
View(foo[[2]][[1]])
foo<-piyo %>% mutate(data=map(data,function(x){x %>% mutate(cnt=map(data,function(y){count(y)[[1]]}))%>% select(-data)}))
View(foo)
View(foo[[2]][[1]])
View(foo[[2]][[1]])
foo<-piyo %>% mutate(data=map(data,function(x){x %>% mutate(cnt=map(data,function(y){count(y)[[1]]}))%>% select(-data) %>% arrange(second)}))
View(foo[[2]][[1]])
foo<-piyo %>% mutate(data=map(data,function(x){x %>% mutate(cnt=map(data,function(y){count(y)[[1]]}))%>% select(-data) %>% arrange(second)}))%>% arrange(first)
View(foo)
rm(hoge)
rm(piyo)
View(foo[[2]][[1]])
foo %>% rowid_to_column()
foo %>% rowid_to_column('fid')
hoge<-foo %>% rowid_to_column('fid')
View(hoge)
View(hoge[[3]][[1]])
View(hoge[[3]][[2]])
View(hoge[[3]][[3]])
View(hoge[[3]][[4]])
piyo<-mutate(first=str_c(fid,' ',first))
piyo<-hoge %>% mutate(first=str_c(fid,' ',first))
View(piyo)
piyo<-hoge %>% mutate(first=str_c(fid,' ',first)) %>% select(-fid)
piyo<-hoge %>% mutate(first=str_c(fid,' ',first)) %>% select(-fid) %>% unnest()
piyo<-hoge %>% mutate(first=str_c(fid,' ',first)) %>% select(-fid) %>% unnest() %>% neset(-second)
piyo<-hoge %>% mutate(first=str_c(fid,' ',first)) %>% select(-fid) %>% unnest() %>% nest(-second)
piyo<-hoge %>% mutate(first=str_c(fid,' ',first)) %>% select(-fid) %>% unnest() %>% nest(-second) %>% arrange(second)
piyo<-hoge %>% mutate(first=str_c(fid,' ',first)) %>% select(-fid) %>% unnest() %>% nest(-second) %>% arrange(second) %>% rowid_to_column('sid')
piyo<-hoge %>% mutate(first=str_c(fid,' ',first)) %>% select(-fid) %>% unnest() %>% nest(-second) %>% arrange(second) %>% rowid_to_column('sid') %>% mutate(second=str_c(sid,' ',second)) %>% select(-sid) %>% unnest
rm(hoge)
tmp(tmp)
View(tmp)
fm(foo)
rm(foo)
hoge<-piyo %>% nest(-second) %>% rowid_to_column('sid') %>% unnest() %>% nest(-first) %>% rowid_to_column('fid') %>% unnest()
View(hoge)
hoge %>% spread(fid,cnt)
foo<-hoge %>% spread(fid,cnt)
View(foo)
foo<-hoge %>% spread(first,cnt)
foo<-hoge
foo<-hoge %>% select(-fid) %>% spread(first,cnt)
write_tsv(foo,'foo.txt')
write_tsv(as_dataframe(foo),'foo.txt')
as_data_frame(foo)
as_tibble(foo)
write_tsv(as_tibble(foo),'hoge.txt')
write_tsv(as_data_frame(foo),'hoge.txt')
bar<-foo %>% select(-sid)
bar
View(dta)
rm(bar)
rm(dta)
fm(foo)
rm(foo)
rm(piyo)
fm(hoge)
rm(hoge)
rm(tmp)
